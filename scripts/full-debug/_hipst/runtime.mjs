function V(q,D){return typeof D==="function"?D(q):D}function k(q,D,J){if(D in q)throw new Error(`Method ${D} already exists`);Object.defineProperty(q,D,{value:(G)=>{let z={self:q},P=V(z,G);return J(z,P)},writable:!0,configurable:!0,enumerable:!1})}function T(q,D){let J=function(...P){let K=D(q,...P);return K===q?z:K},z=new Proxy(J,{get(P,K,Z){if(K==="__hipst_target__")return q;if(K==="apply"||K==="call"||K==="bind"||K==="length"||K==="name"||K==="toString")return Reflect.get(J,K,Z);let Q=q[K];if(typeof Q==="function"){if(Q?.__hipst_no_wrap__)return Q;return(...R)=>{let X=Q.apply(q,R);return X===q?Z:X}}return Q},set(P,K,Z){return q[K]=Z,!0},has(P,K){return K in q},ownKeys(){return Reflect.ownKeys(q)},getOwnPropertyDescriptor(P,K){return Object.getOwnPropertyDescriptor(q,K)}});return z}function U(q){if(q&&(typeof q==="object"||typeof q==="function")&&q.__hipst_target__)return q.__hipst_target__;return q}var j=null,E=new WeakMap;function b(q){let D=q.__deps;if(!D)return;for(let J of D)if(J.set.delete(q),J.set.size===0)J.depsMap.delete(J.key);D.clear()}function M(q){let D=()=>{if(D.__stopped)return;j=D;try{b(D),q()}finally{j=null}};return D.__deps=new Set,D(),D}function m(q){q.__stopped=!0,b(q)}function Y(q,D){if(!j)return;let J=E.get(q);if(!J)E.set(q,J=new Map);let G=J.get(D);if(!G)J.set(D,G=new Set);G.add(j),(j.__deps||=new Set).add({depsMap:J,key:D,set:G})}function W(q,D){let J=E.get(q);if(!J)return;let G=J.get(D);if(!G)return;[...G].forEach((z)=>{if(!z.__stopped)z()})}class x{constructor(){return new Proxy(this,{get(D,J,G){let z=Reflect.get(D,J,G);if(typeof z==="function"){if(z?.__hipst_no_wrap__)return z;return(...P)=>{let K=z.apply(D,P);return K===D?G:K}}return z}})}handle(q,D){return k(this,q,D),this}}class F extends x{_tag;_stateStore={};_propsStore={};_stylesStore={};_attrsStore={};_stateProxy;_propsProxy;_children=[];_callArgs;_effects;_events={};_parent;_root;constructor(q){super();this._tag=q}get tag(){return this._tag}get parent(){return this._parent}set parent(q){this._parent=q}get root(){return this._root}set root(q){this._root=q}get children(){return this._children}get state(){if(!this._stateProxy)this._stateProxy=this.createStateFacade();return this._stateProxy}get props(){if(!this._propsProxy)this._propsProxy=this.createPropsFacade();return this._propsProxy}get styles(){return this._stylesStore}get attributes(){return this._attrsStore}uiCtx(){return{self:this,parent:this._parent,root:this._root,element:void 0,state:this.state,props:this.props,styles:this._stylesStore,attributes:this._attrsStore,children:this._callArgs??[]}}append(...q){for(let D of q){let J=U(D);if(J instanceof F){J.parent=this;let G=this._root??this.findRoot();J.root=G,this._children.push(J)}else{if(typeof D==="function"&&D.__hipst_factory__)continue;this._children.push(D)}}return W(this._children,"__list__"),this}nth(q){let D=this._children[q];return D instanceof F?D:void 0}stateInit(q){Object.assign(this._stateStore,q);for(let D in q)W(this._stateStore,D);return this.__hipst_callable__}typed(){return this.__hipst_callable__}parentTyped(){return this.__hipst_callable__}attr(q,D){return this._attrsStore[q]=D,W(this._attrsStore,"__keys__"),W(this._attrsStore,q),this}style(q,D){if(typeof q==="object"){Object.assign(this._stylesStore,q);for(let J of Object.keys(q))W(this._stylesStore,J);W(this._stylesStore,"__keys__")}else this._stylesStore[q]=D,W(this._stylesStore,q),W(this._stylesStore,"__keys__");return this}id(q){return this.attr("id",q)}className(q){return this.attr("class",q)}class(q){return this.attr("class",q)}classes(q){return this.attr("class",(D)=>{let J=typeof q==="function"?q(D):q;if(Array.isArray(J))return J.filter(Boolean).map(String).join(" ");if(J&&typeof J==="object"){let G=[];for(let[z,P]of Object.entries(J))if(typeof P==="function"?P(D):P)G.push(z);return G.join(" ")}return String(J??"")})}htmlFor(q){return this.attr("for",q)}type(q){return this.attr("type",q)}checked(q){return this.attr("checked",q)}value(q){return this.attr("value",q)}display(q){return this.style("display",q)}flexDirection(q){return this.style("flexDirection",q)}flexCol(){return this.display("flex").flexDirection("column")}flexRow(){return this.display("flex").flexDirection("row")}p(q){if(typeof q==="function")return this.style("padding",(D)=>{let J=q(D);return typeof J==="number"?`${J}px`:J});return this.style({padding:typeof q==="number"?`${q}px`:q})}m(q){if(typeof q==="function")return this.style("margin",(D)=>{let J=q(D);return typeof J==="number"?`${J}px`:J});return this.style({margin:typeof q==="number"?`${q}px`:q})}textCenter(){return this.style({textAlign:"center"})}on(q,D){return(this._events[q]||=[]).push(D),this}onClick(q){return this.on("click",q)}effect(q){return this._effects||=[],this._effects.push(q),this}define(q){let D=this;D.__hipst_invoker__=q;let J=(z)=>{let P=[];for(let K of z)if(Array.isArray(K))P.push(...J(K));else P.push(K);return P},G=T(D,(z,...P)=>{z._callArgs=J(P),W(z,"__call_args__");let K=z.uiCtx();return q(K),z});return D.__hipst_callable__=G,G}prop(q,D){if(this[q])throw new Error(`Method ${String(q)} already exists`);let J=this.__hipst_prop_defs__||={};return J[String(q)]=D,Object.defineProperty(this,q,{value:(G)=>{this._propsStore[String(q)]=G,W(this._propsStore,String(q));let z=this.uiCtx(),P=V(z,G);return D(z,P)},writable:!0,configurable:!0,enumerable:!1}),this.__hipst_callable__}findRoot(){let q=this;while(q&&q.parent)q=q.parent;return q}createStateFacade(){let q=this,D=function(G,z){if(G&&typeof G==="object"&&!Array.isArray(G)){let P=G;for(let K of Object.keys(P))q._stateStore[K]=P[K],W(q._stateStore,K)}else{let P=String(G);q._stateStore[P]=z,W(q._stateStore,P)}return q},J=new Proxy(D,{get(G,z,P){let K=Reflect.get(D,z,P);if(K!==void 0)return K;if(typeof z==="string"){Y(q._stateStore,z);let Z=q._stateStore[z],Q={self:q,parent:q.parent,root:q.root,element:void 0,state:J,props:q.props,styles:q._stylesStore,attributes:q._attrsStore,children:q._callArgs??[]};return V(Q,Z)}return},set(G,z,P){if(typeof z!=="string")return Reflect.set(D,z,P);let K=q._stateStore[z];if(q._stateStore[z]=P,K!==P)W(q._stateStore,z);return!0},deleteProperty(G,z){if(typeof z!=="string")return Reflect.deleteProperty(D,z);let P=delete q._stateStore[z];return W(q._stateStore,z),P},apply(G,z,P){let[K,Z]=P;if(K&&typeof K==="object"&&!Array.isArray(K))for(let Q of Object.keys(K))q._stateStore[Q]=K[Q],W(q._stateStore,Q);else q._stateStore[K]=Z,W(q._stateStore,K);return q.__hipst_callable__??q}});return J.__hipst_no_wrap__=!0,J}createPropsFacade(){let q=this,D=new Proxy({},{get(J,G,z){if(typeof G!=="string")return;Y(q._propsStore,G);let P=q._propsStore[G],K={self:q,parent:q.parent,root:q.root,element:void 0,state:q.state,props:D,styles:q._stylesStore,attributes:q._attrsStore,children:q._callArgs??[]};return V(K,P)},set(J,G,z){if(typeof G!=="string")return Reflect.set({},G,z);let P=q._propsStore[G];if(q._propsStore[G]=z,P!==z)W(q._propsStore,G);return!0},deleteProperty(J,G){if(typeof G!=="string")return!1;let z=delete q._propsStore[G];return W(q._propsStore,G),z}});return D.__hipst_no_wrap__=!0,D}}class y extends F{_title;_metas={};_css=[];constructor(){super("__html_root__");this.root=this}title(q){return this._title=q,this}meta(q,D){return this._metas[q]=D,this}css(q){if(q)this._css.push(q);return this}get headTitle(){return this._title}get headMetas(){return this._metas}get headCss(){return this._css.slice()}}var H=new WeakMap,O=new WeakMap,_=new WeakMap,w=Symbol.for("__hipst_effects__");function I(q,D){let J=q,G=J[w];if(!G)G=new Set,J[w]=G;G.add(D)}function d(q,D,J){let G;if(J===void 0||J===null||J===!1)G=null;else if(J===!0)G="";else G=String(J);let z=H.get(q)||(H.set(q,new Map),H.get(q));if(z.get(D)===G)return;if(z.set(D,G),G===null)q.removeAttribute(D);else q.setAttribute(D,G)}function u(q,D,J){let G=q.style,z=J===void 0||J===null||J===!1?"":J,P=O.get(q)||(O.set(q,new Map),O.get(q));if(P.get(D)===z)return;P.set(D,z),G[D]=z}function C(q,D,J){let G=U(q),z=document.createElement(G.tag),P={self:G,parent:G.parent,root:J,element:z,state:G.state,props:G.props,styles:G.styles,attributes:G.attributes,children:[]};Object.defineProperty(P,"children",{configurable:!0,enumerable:!0,get(){return Y(G,"__call_args__"),(G._callArgs??[]).map(($)=>U($))}});let K=P,Z=G._attrsStore??{};{let X=M(()=>{Y(Z,"__keys__");let $=new Set;for(let[B,N]of Object.entries(Z)){$.add(B),Y(Z,B);let A=V(K,N);d(z,B,A)}let L=H.get(z)||(H.set(z,new Map),H.get(z));for(let B of Array.from(L.keys()))if(!$.has(B))d(z,B,null)});I(z,X)}let Q=G._stylesStore??{};{let X=M(()=>{Y(Q,"__keys__");let $=new Set;for(let B of Object.keys(Q)){$.add(B),Y(Q,B);let N=V(K,Q[B]);u(z,B,N)}let L=O.get(z)||(O.set(z,new Map),O.get(z));for(let B of Array.from(L.keys()))if(!$.has(B))u(z,B,"")});I(z,X)}let R=G._events??{};for(let[X,$]of Object.entries(R)){if(!Array.isArray($))continue;z.addEventListener(X,(L)=>{let B=K;for(let N of $)N(B,L)})}{let X=G._effects??[];for(let $ of X){let L=M(()=>{$(K)});I(z,L)}}{let X=M(()=>{let $=G._children;Y($,"__list__");while(z.firstChild)S(z.firstChild),z.removeChild(z.firstChild);for(let L of $){let B=U(L);if(B instanceof F)C(B,z,J);else if(typeof L==="function"){let N=document.createTextNode("");z.appendChild(N);let A=M(()=>{let h=String(L(K)??"");if(_.get(N)!==h)_.set(N,h),N.data=h});I(N,A)}else z.appendChild(document.createTextNode(String(L)))}});I(z,X)}return D.appendChild(z),z}function S(q){let D=q,J=D[w];if(J){for(let z of J)m(z);D[w]=void 0}let G=q.childNodes;for(let z=0;z<G.length;z++)S(G[z])}function Qq(q,D){S(D);while(D.firstChild)S(D.firstChild),D.removeChild(D.firstChild);let J=U(q);if(J instanceof y){let z=J,P={self:z,parent:void 0,root:z,element:void 0,state:z.state,props:z.props,styles:z.styles,attributes:z.attributes,children:[]},K=z.headTitle;if(K){let Z=M(()=>{let Q=V(P,K);if(typeof document!=="undefined")document.title=String(Q??"")});I(D,Z)}for(let Z of z.children){let Q=U(Z);if(Q instanceof F)C(Q,D,z);else if(typeof Z==="function"){let R=document.createTextNode("");D.appendChild(R);let X=M(()=>{let $=String(Z(P)??"");if(_.get(R)!==$)_.set(R,$),R.data=$});I(R,X)}else D.appendChild(document.createTextNode(String(Z)))}return}let G=J.root??J;C(J,D,G)}export{Qq as mount};

//# debugId=9E7B5065715FE61264756E2164756E21
